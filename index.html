<!DOCTYPE html>
<html lang="sr">
  <head>
    <meta charset="UTF-8" />
    <title>–ß–∏–∫ –ü–æ–≥–æ–¥–∏</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <link rel="stylesheet" href="style.css" />
      <script src="https://cdn.jsdelivr.net/npm/html2canvas@1.4.1/dist/html2canvas.min.js"></script>
  </head>
  <body>
    <button id="hintIconBtn" style="
  position: absolute;
  top: 15px;
  left: 15px;
  font-size: 20px;
  background: none;
  border: none;
  cursor: pointer;
">‚ùì</button>
    <button id="openStatsBtn" title="Statistika" style="position:absolute; top:15px; right:15px; background:none; border:none; font-size:24px; cursor:pointer;">
  üìä
</button>
    <h1 style="font-size: 28px;">–ß–∏–∫ –ü–æ–≥–æ–¥–∏</h1>
    <div id="board"></div>
    <div id="keyboard"></div>
  <div id="hintWrapper" style="display:none; margin-top:10px;">
    <button id="showHintBtn">–ü—Ä–∏–∫–∞–∂–∏ –Ω–∞–≥–æ–≤–µ—à—Ç–∞—ò</button>
    <p id="hintText" style="display:none; margin-top:10px;"></p>
  </div>

    <div id="resultScreen" style="display:none; margin-top:20px;     text-align: center;">
    <h2 id="resultTitle"></h2>
    <div id="resultGrid"></div>
    <button id="shareImageBtn" style="margin-top:15px;">–ü–æ–¥–µ–ª–∏ —Ä–µ–∑—É–ª—Ç–∞—Ç</button>
  </div>

  <div id="timer" style="margin-top: 20px; color: #ccc; margin-bottom: 30px;"></div>
  <div id="stats" style="display: none !important;"></div>


    <div id="statsModal" style="display:none; position:fixed; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,0.5); z-index:999; align-items:center; justify-content:center;">
  <div style="background:#222; padding:20px; border-radius:8px; width:300px; max-width:90%; position:relative;">
    <button id="closeStatsBtn" style="position:absolute; top:5px; right:10px; background:none; border:none; font-size:20px; cursor:pointer;">‚úñÔ∏è</button>
    <h3 style="margin-bottom:15px;">üìà –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞</h3>
    <div id="statsContent"></div>
  </div>
</div>

<!-- Hint Modal -->
<div id="hintModal" style="
  display: none;
  position: fixed;
  top: 0; left: 0; right: 0; bottom: 0;
  background: rgba(0,0,0,0.7);
  justify-content: center;
  align-items: center;
  z-index: 1000;
">
  <div style="
    background: #222;
    padding: 25px;
    border-radius: 10px;
    max-width: 300px;
    text-align: center;
    position: relative;
        min-width: 290px;
    min-height: 60px;
  ">
    <button id="closeHintBtn" style="
      position: absolute;
      top: 8px;
      right: 10px;
      background: none;
      border: none;
      font-size: 18px;
      cursor: pointer;
      color: #fff;
    ">‚úñ</button>
    <p id="hintModalText" style="margin: 0;">Hint text here</p>
  </div>
</div>
    
  <script>
function showResultGrid(win) {
  const boardRows = document.querySelectorAll(".row");
  const resultGrid = document.getElementById("resultGrid");
  const resultTitle = document.getElementById("resultTitle");
  const resultScreen = document.getElementById("resultScreen");

  resultGrid.innerHTML = "";

  // resultTitle.innerHTML = win
  //   ? "Bravo! Pogodili ste reƒç!"
  //   : `Niste pogodili üòû<br><small style="color:#ccc;">Taƒçna reƒç je: <strong>${targetWord.toUpperCase()}</strong></small>`;

if (win) {
  let message = "–ë—Ä–∞–≤–æ! –ü–æ–≥–æ–¥–∏–ª–∏ —Å—Ç–µ —Ä–µ—á!";
  if (currentRow === 0) message = "üåü –ù–µ–≤–µ—Ä–æ–≤–∞—Ç–Ω–æ! –ü–æ–≥–æ–¥–∞–∫ –∏–∑ –ø—Ä–≤–µ!";
  else if (currentRow === 1) message = "üî• –°—ò–∞—ò–Ω–æ! –ü–æ–≥–æ–¥–∏–ª–∏ —Å—Ç–µ –∏–∑ –¥—Ä—É–≥–æ–≥ –ø–æ–∫—É—à–∞—ò–∞!";
  else if (currentRow === 2) message = "üí™ –û–¥–ª–∏—á–Ω–æ! –¢—Ä–µ—õ–∏ –ø–æ–∫—É—à–∞—ò –∏ —É—Å–ø–µ—Ö!";
  else if (currentRow === 3) message = "üëè –ù–∏—ò–µ –±–∏–ª–æ –ª–∞–∫–æ, –∞–ª–∏ —É—Å–ø–µ–ª–∏ —Å—Ç–µ —É —á–µ—Ç–≤—Ä—Ç–æ–º –ø–æ–∫—É—à–∞—ò—É!";
  resultTitle.innerHTML = message;
} else {
  resultTitle.innerHTML = `–ù–∏—Å—Ç–µ –ø–æ–≥–æ–¥–∏–ª–∏ üòû<br><small style="color:#ccc;">–¢–∞—á–Ω–∞ —Ä–µ—á —ò–µ: <strong>${targetWord.toUpperCase()}</strong></small>`;
}
  
  // for (let r = 0; r <= currentRow; r++) {
  //   const rowClone = boardRows[r].cloneNode(true);
  //   rowClone.style.marginBottom = "5px";

  //   // üö´ Remove letter content from tiles
  //   [...rowClone.children].forEach(tile => {
  //     tile.textContent = "";
  //   });

  //   resultGrid.appendChild(rowClone);
  // }
for (let r = 0; r < 7; r++) {
  const row = boardRows[r];
  const rowClone = row.cloneNode(true);
  rowClone.style.marginBottom = "5px";

  [...rowClone.children].forEach(tile => {
    tile.textContent = "";
  });

  resultGrid.appendChild(rowClone);
}
  
  resultScreen.style.display = "block";
  resultScreen.scrollIntoView({ behavior: "smooth" });

  // ‚úÖ Setup share button only now
const shareBtn = document.getElementById("shareImageBtn");
if (shareBtn) {
  shareBtn.onclick = () => {
    const emojiMap = { green: "üü©", orange: "üüß", grey: "‚¨õ" };
    const savedGrid = JSON.parse(localStorage.getItem("last_result_grid") || "[]");

    const shareText = savedGrid.map(row =>
      row.map(tile => emojiMap[tile.color] || "‚¨õ").join("")
    ).join("\n") + "\n–ü–æ–≥–ª–µ–¥–∞—ò –∏–≥—Ä—É: https://bavariah.github.io/cik-pogodi/";

    if (navigator.share) {
      navigator.share({
        title: "–ß–∏–∫ –ü–æ–≥–æ–¥–∏ —Ä–µ–∑—É–ª—Ç–∞—Ç",
        text: shareText
      }).catch(err => {
        console.log("Share canceled or failed", err);
      });
    } else {
      navigator.clipboard.writeText(shareText).then(() => {
        alert("–†–µ–∑—É–ª—Ç–∞—Ç –∫–æ–ø–∏—Ä–∞–Ω! –ú–æ–∂–µ—Ç–µ –≥–∞ –Ω–∞–ª–µ–ø–∏—Ç–∏ —É –∞–ø–ª–∏–∫–∞—Ü–∏—ò—É –∑–∞ –¥–µ—ô–µ—ö–µ.");
      });
    }
  };
}
  // if (shareBtn) {
  //   shareBtn.onclick = () => {
  //     html2canvas(resultGrid, { backgroundColor: null }).then(canvas => {
  //       canvas.toBlob(blob => {
  //         const file = new File([blob], "rezultat.png", { type: "image/png" });
  //         if (navigator.canShare && navigator.canShare({ files: [file] })) {
  //           navigator.share({
  //             files: [file],
  //             title: "ƒåik Pogodi rezultat",
  //             text: "Pogledaj kako sam pro≈°ao u ƒåik Pogodi! https://bavariah.github.io/cik-pogodi/"
  //           });
  //         } else {
  //           const link = document.createElement("a");
  //           link.download = "rezultat.png";
  //           link.href = canvas.toDataURL("image/png");
  //           link.click();
  //         }
  //       });
  //     });
  //   };
  // }
}
  </script>


      <script src="script.js"></script>
  </body>
</html>
